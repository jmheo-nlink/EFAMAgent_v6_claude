#region 변경 이력
/*
 * Author : Link mskoo (2011. 4. 18)
 * 
 * ====================================================================================================================
 * Date         Name            Description of Change
 * --------------------------------------------------------------------------------------------------------------------
 * 2011-04-18   mskoo           최초 작성.
 * 
 * 2011-09-23   mskoo           5.0 버전 릴리즈. (변경 이력 정리)
 * ====================================================================================================================
 */
#endregion

using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Reflection;
using System.Text;
using System.Windows.Forms;
// "Krypton Toolkit" 라이브러리
using ComponentFactory.Krypton.Toolkit;

using AsmblyResource = Link.EFAM.Agent.Properties.Resources;

namespace Link.EFAM.Agent.UI
{
    public partial class AboutBox : KryptonForm
    {
        private Assembly m_execAsmbly = Assembly.GetExecutingAssembly();

        #region 속성

        /// <summary>
        /// 제품 이름에 대한 정보를 가져온다.
        /// </summary>
        /// <value>제품 이름에 대한 정보</value>
        public string AssemblyProduct
        {
            get
            {
                object[] attrs = m_execAsmbly.GetCustomAttributes(typeof(AssemblyProductAttribute), false);

                if (attrs.Length == 0) return "";
                return ((AssemblyProductAttribute)attrs[0]).Product;
            } // get
        }

        /// <summary>
        /// 저작권 정보를 가져온다.
        /// </summary>
        /// <value>저작권 정보</value>
        public string AssemblyCopyright
        {
            get
            {
                object[] attrs = m_execAsmbly.GetCustomAttributes(typeof(AssemblyCopyrightAttribute), false);

                if (attrs.Length == 0) return "";
                return ((AssemblyCopyrightAttribute)attrs[0]).Copyright;
            } // get
        }

        /// <summary>
        /// 파일 버전 정보를 가져온다.
        /// </summary>
        /// <value>파일 버전 정보</value>
        public string AssemblyFileVersion
        {
            get
            {
                object[] attrs = m_execAsmbly.GetCustomAttributes(typeof(AssemblyFileVersionAttribute), false);

                if (attrs.Length == 0) return "";
                return ((AssemblyFileVersionAttribute)attrs[0]).Version;
            } // get
        }

        #endregion

        #region 생성자

        /// <summary>
        /// <see cref="AboutBox"/> 클래스의 새 인스턴스를 초기화한다.
        /// </summary>
        public AboutBox()
        {
            InitializeComponent();

            //
            // 각 컨트롤에 지역화된 텍스트를 설정한다.
            //
            this.Text = AsmblyResource.AboutBox_Text;
            btnOK.Text = AsmblyResource.Button_OK;

            lblProductName.Text = this.AssemblyProduct;
            lblVersion.Text = "Version " + this.AssemblyFileVersion;
            lblCopyright.Text = this.AssemblyCopyright + "\nAll rights reserved.";
        }

        #endregion
    }
}
